<!DOCTYPE html>
<html lang="fr">
<head>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Copyright © 2023 Alméria - Azuriom  -  Serveur semi-rp 1.20.1 - Tous droits réservés">
        <meta name="theme-color" content="#3490DC">
        <meta property="og:title" content="Recherche Decorations • Alméria">
        <meta property="og:type" content="website">
        <meta property="og:description" content="Copyright © 2023 Alméria - Azuriom  -  Serveur semi-rp 1.20.1 - Tous droits réservés">
        <meta property="twitter:url" content="https://almeria-mc.fr">
        <meta property="twitter:description" content="Copyright © 2023 Alméria - Azuriom  -  Serveur semi-rp 1.20.1 - Tous droits réservés">

        <!-- Favicon -->
        <link rel="shortcut icon" href="https://almeria-mc.fr/storage/img/lewlogo2024.png">

        <!-- Fonts -->
        <link href="https://fonts.bunny.net/css?family=nunito:400,700" rel="stylesheet">
        <link href="https://fonts.bunny.net/css2?family=VT323&amp;display=swap" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/vendor/bootstrap-icons/bootstrap-icons.css?v1.1.7" rel="stylesheet">
        <!-- Styles -->

        <style>
            :root {
                --settings-background: url("https://almeria-mc.fr/storage/img/fond.png");

                --color-1:#570000;
                --color-2:#750000;
                --color-3:#212121;
                --color-4:#000000;

                --color-5:rgba(0,0,0, 0.85);


                --text-color-1: #ffffff;
                --text-color-2:  #F5A69E;
                --text-color-3:  #F0E5E0;


                --text-color-4:  #ffffff;
                --text-color-5:  #c7c7c6;
                --text-color-6:  #8f8f8f;
            }

            .hide_noanim {
                visibility: hidden;
                opacity:0;
            }
            a[href]:not(.btn) {
                text-decoration: none;
                color:var(--text-color-2);
            }
            a[href]:not(.btn):hover {
                text-decoration: underline;
            }
        </style>
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/components/sidebar.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/vendor/bootstrap/css/bootstrap.min.css?v1.1.7" rel="stylesheet">

        <link rel="stylesheet" href="https://unpkg.com/@jarstone/dselect/dist/css/dselect.css">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/libraries/animations.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/libraries/core.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/theme.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/libraries/responsive.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/components/home-banner.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/components/news.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/components/profile-section.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/components/ranks.css?v1.1.7" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/modal-video@2.4.8/css/modal-video.min.css">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/components/trailer.css?v1.1.7" rel="stylesheet">
        <link href="https://almeria-mc.fr/assets/themes/deluxe/css/components/discord.css?v1.1.7" rel="stylesheet">

        <!-- Page level styles -->
    </head>
    <meta charset="UTF-8">
</head>
<body data-bs-theme="dark">
<script type="text/javascript">
    class Deco{
        get events() {
            return this._events;
        }
        get craftable() {
            return this._craftable;
        }
        get tags() {
            return this._tags;
        }
        get name() {
            return this._name;
        }
        get pnj_id() {
            return this._pnj_id;
        }
        get image() {
            return this._image;
        }
        get price() {
            return this._price;
        }
        get id() {
            return this._id;
        }
        constructor(id, name, pnj_id, image, price, event, craftable, tags) {
            this._name = name;
            this._pnj_id = pnj_id;
            this._image = image;
            this._price = price;
            this._id = id;
            this._events = event;
            this._craftable = craftable;
            this._tags = tags;
        }
    }
    class Pnj{
        get name() {
            return this._name;
        }
        get coordinates() {
            return this._coordinates;
        }
        get ville_id() {
            return this._ville_id;
        }
        get id() {
            return this._id;
        }
        constructor(id, name, coordinates, ville_id) {
            this._name = name;
            this._coordinates = coordinates;
            this._ville_id = ville_id;
            this._id = id;
        }
    }
    class Villes{
        get name() {
            return this._name;
        }
        get mayors() {
            return this._mayors;
        }
        constructor(name, mayors) {
            this._name = name
            this._mayors = mayors;
        }
    }

    const levenshteinDistance = (s, t) => {
        if (!s.length) return t.length;
        if (!t.length) return s.length;
        const arr = [];
        for (let i = 0; i <= t.length; i++) {
            arr[i] = [i];
            for (let j = 1; j <= s.length; j++) {
                arr[i][j] =
                    i === 0
                        ? j
                        : Math.min(
                            arr[i - 1][j] + 1,
                            arr[i][j - 1] + 1,
                            arr[i - 1][j - 1] + (s[j - 1] === t[i - 1] ? 0 : 1)
                        );
            }
        }
        return arr[t.length][s.length];
    };
    const calculate = (a,b) => {
        return levenshteinDistance(a.toLowerCase(),b.toLowerCase()) < 3;
    }
    const getPnj = (id)=>{
        let result;
        pnjs.forEach(pnj=>{
            if(pnj._id === id){
                result = pnj;
            }
        });
        return result;
    }
    const createDeco = (name, pnj_id, price, event, craftable, tags)=>{
        id_deco += 1;
        return new Deco(id_deco, name, pnj_id, "img/" + name + ".png" , price, event, craftable, tags);
    }


    const searchInVille = (recherche) =>{
        let result = [];
        villes.forEach(ville=> {
            if (calculate(recherche,ville.name)){
                if(!result.includes(ville)){
                    result.push(ville);
                }
            }
            ville._mayors.forEach(mayor => {
                if (calculate(recherche,mayor)){
                    if(!result.includes(ville)){
                        result.push(ville);
                    }
                }
            })
        });
        return result;
    };

    const getPnjByName = (name) =>{
        let result = [];
        pnjs.forEach(pnj => {
            if (calculate(name,pnj._name)){
                if (!result.includes(pnj)){
                    result.push(pnj);
                }
            }
        });
        return result;
    }
    const getDecoInPnj = (pnj)=>{
        let result = [];
        decos.forEach(deco=>{
            if(deco.pnj_id === pnj){
                result.push(deco);
            }
        });
        return result;
    }
    const searchDeco = (recherche) =>{
        let result = [];
        decos.forEach(deco =>{
            if(calculate(recherche,deco._name)){
                if(!result.includes(deco)){
                    result.push(deco);
                }
            }
        });

        searchInVille(recherche).forEach(ville=>{
            getDecoInVille(ville,decos).forEach(deco => {
                if(!result.includes(deco)){
                    result.push(deco);
                }
            });
        });

        getPnjByName(recherche).forEach(pnj => {
            getDecoInPnj(pnj).forEach(deco => {
                if(!result.includes(deco)){
                    result.push(deco);
                }
            });
        });

        //ajouter les tags plus tard
        return result;
    }

    let villes = [];
    let pnjs =[];
    let decos = [];

    let id_deco = 0;
    /**
     * data ville
     */
    const Shinshiro = "Shinshiro";
    const Eriador = "Eriador";
    const Yrias = "Yrias";
    const Florenia = "Florénia";
    const Highland = "Highland";
    const Rome = "Rome";
    const Imynda = "Imynda";
    const Inpou = "Inpou";
    const Almeria = "Alméria";
    const Azuria = "Azuria";
    const Drakaina = "Drakaina";
    const Nakaram = "Nakaram";
    const Villers = "Villers";
    const Nassau = "Nassau";
    const Helios = "Helios";
    const Kotaiblis = "Kotaiblis";
    const Alorah = "Alorah";

    villes.push(new Villes(Eriador, ["jerem1664", "Nisudry"]));
    villes.push(new Villes(Yrias, ["_Ybrakxar"]));
    villes.push(new Villes(Shinshiro, ["DVN88819"]));
    villes.push(new Villes(Florenia,["Flifloux"]));
    villes.push(new Villes(Highland,["MissDu39","Kimalo"]));
    villes.push(new Villes(Rome,["kiefer_grylls", "klein1445"]));
    villes.push(new Villes(Imynda,["Djox79"]));
    villes.push(new Villes(Inpou,["Gorderok", "Zzheyd"]));
    villes.push(new Villes(Almeria,["Gorderok", "Zzheyd"]));
    villes.push(new Villes(Azuria,["Zappax0"]));
    villes.push(new Villes(Drakaina,["_Minesta_"]));
    villes.push(new Villes(Nakaram,["Adidix"]));
    villes.push(new Villes(Villers,["Tintin1712"]));
    villes.push(new Villes(Nassau,["Glommery"]));
    villes.push(new Villes(Helios,["LeftForDeath6"]));
    villes.push(new Villes(Kotaiblis,["Xof__"]));
    villes.push(new Villes(Alorah,["Gorderok", "Zzheyd"]));
    /**
     * data ville
     */
    const getVille = (name)=>{
        let result;
        villes.forEach(ville=> {
            if(ville._name === name){
                result = ville
            }
        });
        return result;
    }
    /**
     * données pnj
     */
    pnjs.push(new Pnj(1, "Kazuo","x=-14142,y=73,z=548",getVille(Shinshiro)))
    pnjs.push(new Pnj(2,"Fumiaki","x=-14234,y=98,z=846",getVille(Shinshiro)))
    pnjs.push(new Pnj(3,"Hanaya","x=-14234,y=98,z=846",getVille(Shinshiro)))
    pnjs.push(new Pnj(4,"Hiroyuki","x=-14292,y=45,z=956",getVille(Shinshiro))) // tete de ville
    pnjs.push(new Pnj(5,"Sanemoto","x=-14251,y=64,z=960",getVille(Shinshiro)))
    pnjs.push(new Pnj(6,"Kaori","x=-14251,y=64,z=941",getVille(Shinshiro)))
    pnjs.push(new Pnj(7,"Junichi","x=-14251,y=64,z=941",getVille(Shinshiro)))
    pnjs.push(new Pnj(8,"Anzu","x=-14245,y=64,z=921",getVille(Shinshiro)))
    pnjs.push(new Pnj(9,"Masuku","x=-14066,y=71,z=1064",getVille(Shinshiro)))
    pnjs.push(new Pnj(10,"Shigehiko","x=-14066,y=71,z=1064",getVille(Shinshiro)))
    pnjs.push(new Pnj(11,"Taximoto","x=-14028,y=67,z=1111",getVille(Shinshiro)))
    pnjs.push(new Pnj(11,"Rantanmeka","x=-14035,y=67,z=1111",getVille(Shinshiro)))
    /**
     * données pnj
     */


    /**
     * données decos
     */
    decos.push(createDeco("Pousse de Bambou", getPnj(1),"5 blocs d'émeraude","","oui",["bambou","plante"]));
    decos.push(createDeco("Tronc De Bambou", getPnj(1),"5 blocs d'émeraude","","oui",["bambou","plante"]));
    decos.push(createDeco("Citrouille Japonaise", getPnj(1),"5 blocs d'émeraude","","oui",["plante","citrouille"]));
    decos.push(createDeco("Durian", getPnj(1),"5 blocs d'émeraude","","oui",["plante"]));
    decos.push(createDeco("Plan de construction", getPnj(2),"5 blocs d'émeraude","","oui",["maison","plan"]));
    decos.push(createDeco("Bonsaï cerisier à fleurs", getPnj(3),"vase + 64 poudres d'os","","oui",["plante","arbre","cerisier","bonsaï"]));
    decos.push(createDeco("Bonsaï ancien", getPnj(3),"vase + 64 poudres d'os","","oui",["plante","arbre","bonsaï"]));
    decos.push(createDeco("Sabot de vénus en pot", getPnj(3),"vase + 64 poudres d'os","","oui",["plante"]));
    decos.push(createDeco("Bambous en pot", getPnj(3),"vase + 64 poudres d'os","","oui",["plante","bambou"]));
    decos.push(createDeco("Roseaux en pot", getPnj(3),["https://cdn.discordapp.com/attachments/1251252569691656204/1251547440574894192/image.png?ex=666ef9e2&is=666da862&hm=7755c89b1dd3618ef7080d73a620609f8a9c9ccc5751de82f2b7175631d3c9af&"],"vase + 64 poudres d'os","","oui",["plante"]));
    decos.push(createDeco("Lilas en pot", getPnj(3),"vase + 64 poudres d'os","","oui",["plante","fleur"]));
    decos.push(createDeco("Schlumbergera en pot", getPnj(3),"vase + 64 poudres d'os","","oui",["plante","fleur"]));
    decos.push(createDeco("Cactus en pot", getPnj(3),"vase + 64 poudres d'os","","oui",["plante","cactus"]));
    decos.push(createDeco("vase noir", getPnj(5),"5 blocs d'émeraude","","oui",["noir"]));
    decos.push(createDeco("vase orange", getPnj(5),"5 blocs d'émeraude","","oui",["orange"]));
    decos.push(createDeco("vase marron", getPnj(5),"5 blocs d'émeraude","","oui",["marron"]));
    decos.push(createDeco("vase jaune", getPnj(5),"5 blocs d'émeraude","","oui",["jaune"]));
    decos.push(createDeco("vase violet", getPnj(5),"5 blocs d'émeraude","","oui",["violet"]));
    decos.push(createDeco("vase blanc", getPnj(5),"5 blocs d'émeraude","","oui",["blanc"]));
    decos.push(createDeco("vase bleu", getPnj(5),"5 blocs d'émeraude","","oui",["bleu"]));
    decos.push(createDeco("vase vert", getPnj(5),"5 blocs d'émeraude","","oui",["vert"]));
    decos.push(createDeco("Farine", getPnj(6),"5 blocs d'émeraude","","oui",["ingredient"]));
    decos.push(createDeco("Pain", getPnj(6),"5 blocs d'émeraude","","oui",["pain"]));
    decos.push(createDeco("Pain moisi", getPnj(6),"5 blocs d'émeraude","","oui",["pain"]));
    decos.push(createDeco("Pain de seigle", getPnj(6),"5 blocs d'émeraude","","oui",["pain"]));
    decos.push(createDeco("Pain de romarin", getPnj(6),"5 blocs d'émeraude","","oui",["pain"]));
    decos.push(createDeco("Pain aux noix de raisin", getPnj(6),"5 blocs d'émeraude","","oui",["pain"]));
    decos.push(createDeco("Pain au levain", getPnj(6),"5 blocs d'émeraude","","oui",["pain"]));
    decos.push(createDeco("vase rose", getPnj(7),"5 blocs d'émeraude","","oui",["rose"]));
    decos.push(createDeco("vase bleu foncé", getPnj(7),"5 blocs d'émeraude","","oui",["bleu"]));
    decos.push(createDeco("vase jaune 2", getPnj(7),"5 blocs d'émeraude","","oui",["jaune"]));
    decos.push(createDeco("vase cyan", getPnj(7),"5 blocs d'émeraude","","oui",["bleu"]));
    decos.push(createDeco("vase violet foncé", getPnj(7),"5 blocs d'émeraude","","oui",["violet"]));
    decos.push(createDeco("vase blanc jaune", getPnj(7),"5 blocs d'émeraude","","oui",["blanc"]));
    decos.push(createDeco("vase rouge", getPnj(7),"5 blocs d'émeraude","","oui",["rouge"]));
    decos.push(createDeco("vase gris", getPnj(7),"5 blocs d'émeraude","","oui",["gris"]));
    decos.push(createDeco("Cheminée en brique", getPnj(8),"5 blocs d'émeraude","","oui",["tete deco","maison"]));
    decos.push(createDeco("Cheminée en pierre taillée moussue", getPnj(8),"5 blocs d'émeraude","","oui",["tete deco","maison"]));
    decos.push(createDeco("Cheminée en pierre moussue", getPnj(8),"5 blocs d'émeraude","","oui",["tete deco","maison"]));
    decos.push(createDeco("Cheminée en roche lisse", getPnj(8),"5 blocs d'émeraude","","oui",["tete deco","maison"]));
    decos.push(createDeco("Cheminée pierre", getPnj(8),"5 blocs d'émeraude","","oui",["tete deco","maison"]));
    decos.push(createDeco("Cheminée en roche", getPnj(8),"5 blocs d'émeraude","","oui",["tete deco","maison"]));
    decos.push(createDeco("Cheminée pierre taillée", getPnj(8),"5 blocs d'émeraude","","oui",["tete deco","maison"]));
    decos.push(createDeco("Masque homme 1", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","homme"]));
    decos.push(createDeco("Masque homme 2", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","homme"]));
    decos.push(createDeco("Masque homme 3", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","homme"]));
    decos.push(createDeco("Masque homme 4", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","homme"]));
    decos.push(createDeco("Masque femme 1", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","femme"]));
    decos.push(createDeco("Masque femme 2", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","femme"]));
    decos.push(createDeco("Masque femme 3", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","femme"]));
    decos.push(createDeco("Masque femme 4", getPnj(9),"2 blocs d'émeraude","","oui",["tete deco","masque","personnage","femme"]));
    decos.push(createDeco("Feuilles 1", getPnj(10),"5 blocs d'émeraude","","oui",["tete deco","arbre","plante"]));
    decos.push(createDeco("Feuilles 2", getPnj(10),"5 blocs d'émeraude","","oui",["tete deco","arbre","plante"]));
    decos.push(createDeco("Feuilles 3", getPnj(10),"5 blocs d'émeraude","","oui",["tete deco","arbre","plante"]));
    decos.push(createDeco("Tronc et Feuilles 1", getPnj(10),"5 blocs d'émeraude","","oui",["tete deco","arbre","plante", "bois"]));
    decos.push(createDeco("Tronc et Feuilles 2", getPnj(10),"5 blocs d'émeraude","","oui",["tete deco","arbre","plante", "bois"]));
    decos.push(createDeco("Tronc et Feuilles 3", getPnj(10),"5 blocs d'émeraude","","oui",["tete deco","arbre","plante", "bois"]));

    decos.push(createDeco("Lampion rouge simple", getPnj(11),"64 teintures rouges / 1 Almericoins bronze ","","oui",["lampion"]));
    decos.push(createDeco("Lampion rouge à frange", getPnj(11),"Lampion rouge simple / 16 pepites d'or","","oui",["lampion"]));
    decos.push(createDeco("Lampion rouge colonne", getPnj(11),"3 Lampion rouge simple / 32 papier","","oui",["lampion"]));


    decos.push(createDeco("Lampion Exterieur", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion rouge", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion Exotique", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion Vert", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion Bicolore", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion Orange", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion Rose", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion de fête", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));
    decos.push(createDeco("Lampion festif", getPnj(11),"5 blocs d'émeraude","","non",["tete deco","lampion"]));


    decos.push(createDeco("Chapeau crabe", getPnj(12),"5 blocs d'émeraude","","oui",["tete","crabe"]));
    /**
     * données decos
     */

    const getDecoInVille = (ville, decos)=>{
        let result = [];
        decos.forEach(deco=>{
            console.log(deco)
            if(deco._pnj_id._ville_id._name === ville){
                result.push(deco);
            }
        });
        return result;
    }

</script>




<div id="app" class="home">
    <main id="content">
        <div class="content-wrapper">
            <div style="padding-bottom:70px;">

                <div class="row">
                    <div class="col-md-12">
                        <div id="section-1">
                            <section class="row py-3 no-padding ">
                                <div class="col-12">
                                    <div id="homebanner">
                                        <div class="hommebanner-content">
                                            <form action="" method="get">
                                                <label for="recherche"></label><input type="text" id="recherche" name="recherche"/>
                                                <input type="submit" value="rechercher"/>
                                            </form>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>
                        <div id="section-2">
                            <section class="row py-3 "  id="deco_list">




                            </section>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </main>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    let recherche = params.get("recherche");
    const result = recherche === undefined || recherche === null || recherche === "" ? decos :  searchDeco(recherche);

    const createDecoRender = (deco) =>{
        let divMD4 = document.createElement('div');
        divMD4.className = "col-md-3";

        let divPB2 = document.createElement('div');
        divPB2.className = "mb-3 pb-2";

        let divDate = document.createElement('div');
        divDate.className = "date-wrapper";

        let divPost = document.createElement('div')
        divPost.className = "post"
        divPost.style = `background-image:url('${deco.image}');`

        let divContent = document.createElement('div');
        divContent.className = "content";

        let h5 = document.createElement('h5');
        h5.className = "title mt-2";
        h5.innerHTML = deco.name;

        let pmb1 = document.createElement('p');
        pmb1.className = "description mb-1";
        pmb1.innerHTML = `Pnj: ${deco.pnj_id.name} / Ville : ${deco.pnj_id.ville_id.name} <br> position : ${deco.pnj_id.coordinates}`

        let divAction = document.createElement('div');
        divAction.className = "action";

        let spanValue = document.createElement('span');
        spanValue.className = "value";
        spanValue.innerHTML = deco.price

        let h6Date = document.createElement('h6');
        h6Date.className = "date";

        let spanValueCraft = document.createElement('span');
        spanValueCraft.className = "value";
        spanValueCraft.innerHTML = deco.craftable === "oui" ? "Achetable" : "Non-achetables";

        h6Date.appendChild(spanValueCraft);
        divContent.appendChild(h5);
        divContent.appendChild(pmb1);

        divAction.appendChild(spanValue);
        divContent.appendChild(divAction);

        divPost.appendChild(divContent);
        divDate.appendChild(divPost);
        divDate.appendChild(h6Date);
        divPB2.appendChild(divDate);
        divMD4.appendChild(divPB2);
        return divMD4;
    }
    let listDecos = document.getElementById("deco_list");
    console.log(result)
    result.forEach(deco =>{
        listDecos.appendChild(createDecoRender(deco));
    });

</script>

</body>
</html>